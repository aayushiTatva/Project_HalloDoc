
@*
    For more information on enabling MVC for empty projects, visit http://go.microsoft.com/fwlink/?LinkID=397860
*@
@model HalloDocMVC.DBEntity.ViewModels.AdminPanel.SchedulingModel

<div class="modal fade" id="viewShiftModal" tabindex="-1" aria-labelledby="viewShiftModalLabel1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-info text-white">
                <h5 class="modal-title" id="viewShiftModalLabel">View Shift</h5>
                <i class="fa-solid fa-xmark" data-bs-dismiss="modal"></i>
            </div>
            <form asp-action="ViewShiftreturn" asp-controller="Scheduling" id="ViewShiftForm">
                <input asp-for="ShiftDetailId" type="hidden" id="shiftmodalid" />
                <div class="modal-body">
                    <div class="form-floating">
                        <select asp-for="RegionId" class="form-select" data-allow-clear="true" tabindex="-1" id="shiftmodalRegion" asp-items="@(new SelectList(ViewBag.RegionComboBox,"RegionId","RegionName"))" data-control="select2" data-placeholder="Select Level" disabled>
                            <option value="">Select Region</option>
                        </select>
                        <label for="floatingSelect" class="text-info">
                            Region
                        </label>
                    </div>
                    <select asp-for="PhysicianId" class="form-select mt-4" id="physelect2" aria-label="Floating label select example" style="height:58px" disabled>
                        <option id="shiftmodalPhysician" selected>Select Physician</option>
                    </select>
                    <div class="form-floating mt-3">
                        <input asp-for="ShiftDate" type="date" min="@DateTime.Now.ToString("yyyy-MM-dd")" id="shiftmodalDate" class="form-control disable shadow-none" placeholder="Date" readonly>
                        <label for="floatingInput">Shift Date</label>
                    </div>
                    <div class="row row-cols-md-2 row-cols-sm-1 row-cols-1 mt-3">
                        <div class="col mb-3 mb-md-0">
                            <div class="form-floating">
                                <input asp-for="StartTime" type="time" class="form-control disable shadow-none" id="shiftmodalStart" placeholder="Date" readonly />
                                <label for="floatingInput">Start</label>
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-floating">
                                <input asp-for="EndTime" type="time" class="form-control disable shadow-none" id="shiftmodalEnd" placeholder="Date" readonly />
                                <label for="floatingInput">End</label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" id="returnbtn" class="btn btn-info text-white">Return</button>
                    <button type="button" onclick="editclick()" class="btn btn-info text-white edit">Edit</button>
                    <button type="button" onclick="SaveShift()" class="btn btn-info text-white d-none save">Save</button>
                    <button type="reset" onclick="cancelclick()" class="btn btn-outline-info d-none cancel">Cancel</button>
                    <button type="button" onclick="DeleteShift()" class="btn btn-danger text-white">Delete</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    function editclick() {
        $('.cancel').removeClass('d-none').addClass('d-inline-block');
        $('.edit').removeClass('d-inline-block').addClass('d-none');
        $('.save').removeClass('d-none').addClass('d-inline-block');
        $('.disable').each(function () {
            $(this).prop('readonly', false);
        });
    }
    function cancelclick() {
        $('.edit').removeClass('d-none').addClass('d-inline-block');
        $('.cancel').removeClass('d-inline-block').addClass('d-none');
        $('.save').removeClass('d-inline-block').addClass('d-none');
        $('.disable').each(function () {
            $(this).prop('readonly', true);
        });
    }

    function SaveShift() {
        var modal = $('#ViewShiftForm').serialize();
        $.ajax({
            type: "POST",
            url: '@Url.Action("EditShiftSave", "Scheduling")',
            cache: false,
            data: modal,
            success: function (response) {
                console.log(response);
            },
            error: function () {
                alert("Error .");
            }
        });
        $('.cancel').removeClass('d-inline-block').addClass('d-none');
        $('.edit').removeClass('d-none').addClass('d-inline-block');
        $('.save').removeClass('d-inline-block').addClass('d-none');
        $('.disable').each(function () {
            $(this).prop('readonly', true);
        });
    }
    function DeleteShift() {
        var modal = $('#ViewShiftForm').serialize();
        $.ajax({
            type: "POST",
            url: '@Url.Action("ViewShiftDelete", "Scheduling")',
            cache: false,
            data: modal,
            success: function (response) {
                console.log(response);
                location.reload();
            },
            error: function () {
                alert("Error .");
            }
        });
    }

    $('.cancel').on('click', function () {
        var shiftdetailid = $('#shiftmodalid').val();
        $.ajax({
            url: '/Scheduling/ViewShift',
            data: { "shiftdetailid": shiftdetailid },
            success: function (response) {
                $('#shiftmodalRegion').val(response.regionId);
                $('#shiftmodalPhysician').text(response.physicianName);
                $('#shiftmodalDate').val(response.modalDate);
                $('#shiftmodalStart').val(response.startTime);
                $('#shiftmodalEnd').val(response.endTime);
                $('#shiftmodalid').val(response.shiftDetailId);
            },
            error: function (xhr, status, error) {
                console.error(error);
            }
        });
    });
</script>